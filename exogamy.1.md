exogamy.1
================
Robert Z. Selden, Jr.
27 November, 2022

## Stemmed arrow points

### Load packages + data

``` r
# load packages
devtools::install_github("MomX/Momocs")
```

    Skipping install of 'Momocs' from a github remote, the SHA1 (7b8ed7a7) has not changed since last install.
      Use `force = TRUE` to force installation

``` r
library(here)
```

    here() starts at D:/github/exogamy.1

``` r
library(Momocs)
```


    Attaching package: 'Momocs'

    The following object is masked from 'package:stats':

        filter

``` r
# read images
jpg.list <- list.files("stemmed", 
                       full.names = TRUE)

# read attribute data
att.data <- read.csv("stemmed.csv", 
                     header = TRUE, 
                     as.is = TRUE)

# attribute to factor
att.data$burial <- as.factor(att.data$burial)
att.data$site <- as.factor(att.data$site)
```

### Generate outlines

``` r
# generate outlines
outlines <- jpg.list %>%
  import_jpg()
```

    Extracting 54.jpg outlines...

    [ 1 / 54 ]  592.jpg
    [ 2 / 54 ]  593.jpg
    [ 3 / 54 ]  594.jpg
    [ 4 / 54 ]  602.jpg
    [ 5 / 54 ]  604.jpg
    [ 6 / 54 ]  605.jpg
    [ 7 / 54 ]  606.jpg
    [ 8 / 54 ]  607.jpg
    [ 9 / 54 ]  608.jpg
    [ 10 / 54 ]  610.jpg
    [ 11 / 54 ]  611.jpg
    [ 12 / 54 ]  612.jpg
    [ 13 / 54 ]  F7.2.B.jpg
    [ 14 / 54 ]  F7.2.C.jpg
    [ 15 / 54 ]  F7.2.D.jpg
    [ 16 / 54 ]  F7.2.F.jpg
    [ 17 / 54 ]  F7.2.G.jpg
    [ 18 / 54 ]  F7.2.H.jpg
    [ 19 / 54 ]  F7.2.J.jpg
    [ 20 / 54 ]  F7.2.K.jpg
    [ 21 / 54 ]  F7.2.L.jpg
    [ 22 / 54 ]  F7.2.M.jpg
    [ 23 / 54 ]  F7.2.N.jpg
    [ 24 / 54 ]  F7.2.O.jpg
    [ 25 / 54 ]  F7.2.Q.jpg
    [ 26 / 54 ]  F7.2.R.jpg
    [ 27 / 54 ]  F7.2.S.jpg
    [ 28 / 54 ]  F7.3.A.jpg
    [ 29 / 54 ]  F7.3.AA.jpg
    [ 30 / 54 ]  F7.3.B.jpg
    [ 31 / 54 ]  F7.3.C.jpg
    [ 32 / 54 ]  F7.3.D.jpg
    [ 33 / 54 ]  F7.3.E.jpg
    [ 34 / 54 ]  F7.3.F.jpg
    [ 35 / 54 ]  F7.3.G.jpg
    [ 36 / 54 ]  F7.3.H.jpg
    [ 37 / 54 ]  F7.3.I.jpg
    [ 38 / 54 ]  F7.3.J.jpg
    [ 39 / 54 ]  F7.3.K.jpg
    [ 40 / 54 ]  F7.3.L.jpg
    [ 41 / 54 ]  F7.3.M.jpg
    [ 42 / 54 ]  F7.3.N.jpg
    [ 43 / 54 ]  F7.3.O.jpg
    [ 44 / 54 ]  F7.3.P.jpg
    [ 45 / 54 ]  F7.3.Q.jpg
    [ 46 / 54 ]  F7.3.R.jpg
    [ 47 / 54 ]  F7.3.S.jpg
    [ 48 / 54 ]  F7.3.T.jpg
    [ 49 / 54 ]  F7.3.U.jpg
    [ 50 / 54 ]  F7.3.V.jpg
    [ 51 / 54 ]  F7.3.W.jpg
    [ 52 / 54 ]  F7.3.X.jpg
    [ 53 / 54 ]  F7.3.Y.jpg
    [ 54 / 54 ]  F7.3.Z.jpg

    Done in 12.6 secs

``` r
# add attributes
data.out <- Out(outlines, 
         fac = att.data)

# scale, align, rotate, and center specimens
norm.outlines <- data.out %>% 
  coo_scale() %>%
  coo_align() %>% 
  coo_center()
```

### Calibrate harmonic + EFA

``` r
# calibrate how many harmonics needed
calibrate_harmonicpower_efourier(norm.outlines, 
                                 nb.h = 30)
```

    $gg

<img src="exogamy.1_files/figure-gfm/cal.harm-1.png"
style="width:100.0%" />


    $q
                   h1       h2       h3       h4       h5       h6       h7
    592     72.510002 78.77776 93.13734 93.32068 94.14786 95.86062 96.49835
    593     70.618655 85.62441 94.11427 94.54130 96.05843 97.20995 97.38077
    594     59.490733 81.30755 93.82101 94.22621 97.46228 97.56656 97.80085
    602     64.669202 81.68433 92.75853 92.96653 94.65291 95.93910 96.26243
    604     78.560454 79.00303 84.81014 92.07192 94.82706 98.99884 99.20785
    605     69.204778 80.08063 94.35374 94.74173 95.73013 96.82000 97.42504
    606     73.755861 74.27456 79.80909 88.31890 92.05805 97.96041 98.82026
    607     65.506294 67.05261 74.70683 82.56232 85.37273 94.93342 97.11974
    608     63.770260 69.45409 82.04911 84.30490 88.20768 92.98746 96.02773
    610     73.343517 78.78053 89.80631 90.58540 91.41999 94.57237 95.96768
    611     70.601536 72.86016 81.68505 86.27352 88.30677 95.33852 97.35729
    612     71.287724 81.01143 94.07819 94.35893 96.10078 96.75118 96.87285
    F7.2.B  41.643137 62.37865 69.04836 88.21674 92.94795 96.66719 98.27726
    F7.2.C  26.386676 64.88109 73.05640 90.91911 94.21716 97.83583 98.59561
    F7.2.D  50.456042 62.36893 67.96823 90.98516 95.06127 97.32514 98.55961
    F7.2.F  37.664670 53.39110 62.78908 84.60813 90.06011 95.63933 97.28201
    F7.2.G  14.481379 66.54427 73.50670 92.08633 95.51066 96.30864 97.37020
    F7.2.H  68.888334 77.14635 84.61363 88.29827 89.73104 94.80495 95.93011
    F7.2.J  72.869358 79.16156 93.09026 93.40728 93.75493 96.36908 97.47117
    F7.2.K  70.336411 81.28446 94.58349 94.72505 95.33758 97.30761 98.17235
    F7.2.L  75.760846 77.76209 86.81077 90.32020 92.03390 97.05085 98.24836
    F7.2.M  39.280868 62.29105 76.89412 95.04960 96.15574 96.97685 98.37395
    F7.2.N  80.958137 83.00498 90.38190 92.47801 93.74833 97.93172 98.76495
    F7.2.O  46.135957 62.16167 71.29648 93.89491 96.53622 97.12909 98.81492
    F7.2.Q  48.653698 63.80547 72.54786 93.77398 96.43364 97.18498 99.03928
    F7.2.R  37.219617 62.12577 70.70247 91.64087 95.59085 96.78128 98.34032
    F7.2.S  80.136856 82.40906 89.12108 92.17409 93.51458 97.83641 98.73047
    F7.3.A   7.074863 67.36642 71.87446 90.83765 95.20554 95.44454 96.29300
    F7.3.AA 48.212026 67.01366 71.04355 89.00360 92.66381 97.16383 98.06597
    F7.3.B  18.024894 67.03652 71.23107 88.52515 92.01336 96.09269 97.55509
    F7.3.C  77.551258 81.88805 90.29313 93.65556 94.35715 96.97464 97.47857
    F7.3.D  11.227923 71.99420 77.66632 91.44556 94.13308 95.13908 96.48297
    F7.3.E  16.754782 65.32960 69.79745 88.32619 94.62832 96.13823 97.99274
    F7.3.F  30.432861 65.54440 71.80458 90.38211 94.17661 96.35110 97.91131
    F7.3.G  23.562428 57.34009 65.16226 89.07960 92.91864 96.27465 97.78118
    F7.3.H  22.134796 69.29186 79.39669 93.49045 96.46317 97.04035 97.44127
    F7.3.I  28.314893 56.41768 64.28227 90.11871 93.80529 95.51798 97.58420
    F7.3.J  21.363367 64.87095 70.16458 89.05764 92.46145 95.61667 97.00726
    F7.3.K  27.583792 65.65292 71.86338 90.57536 95.32237 96.58544 98.01568
    F7.3.L  22.192611 60.85298 66.60634 89.49685 93.59457 95.88077 97.26599
    F7.3.M  13.059755 58.55168 64.91771 87.36908 90.53975 94.84567 96.04453
    F7.3.N  23.870386 66.33041 72.50497 90.70112 93.94132 96.32310 97.68679
    F7.3.O  34.170699 64.30358 68.63604 89.09895 92.66057 95.98711 98.30675
    F7.3.P  29.321564 56.95377 64.94423 90.27162 93.89505 95.61235 97.65547
    F7.3.Q   9.272423 69.03096 74.82349 91.80775 97.19008 97.36782 98.06251
    F7.3.R  31.855547 57.76724 67.47296 87.85346 90.45977 95.86873 96.63562
    F7.3.S  63.225107 69.30751 72.77151 89.30818 93.47419 97.76192 98.48495
    F7.3.T  12.188775 65.89040 72.64525 90.54856 95.80847 96.21191 97.17666
    F7.3.U  24.357633 63.56717 68.18639 87.10973 89.36481 95.08345 95.89593
    F7.3.V  51.766878 68.76693 75.03830 89.86781 92.49343 95.25283 97.06285
    F7.3.W  15.601473 61.99321 70.01836 88.48277 93.54359 95.56057 97.11934
    F7.3.X  18.776133 63.77946 68.40772 89.30583 94.89965 96.35161 98.24923
    F7.3.Y  30.424238 65.10796 72.42781 91.08928 94.61246 96.07681 98.32369
    F7.3.Z  46.092916 64.83134 74.91776 92.64112 96.10315 97.44887 98.52757
                  h8       h9      h10      h11      h12      h13      h14      h15
    592     98.78130 99.22294 99.71359 99.71792 99.73357 99.78309 99.78826 99.80121
    593     98.47844 98.82225 99.32140 99.36737 99.50311 99.55777 99.58117 99.61043
    594     98.24802 98.40462 99.14187 99.27392 99.64060 99.66355 99.68595 99.72524
    602     98.17271 98.56050 99.32119 99.40357 99.50437 99.59860 99.63827 99.75960
    604     99.29175 99.55613 99.57248 99.68286 99.77841 99.81082 99.83469 99.88298
    605     98.91674 99.30741 99.72332 99.73682 99.74626 99.80610 99.82259 99.83718
    606     99.12227 99.41912 99.46689 99.54185 99.63499 99.72517 99.76808 99.83350
    607     98.47396 98.77968 98.92631 99.44450 99.53340 99.58957 99.70731 99.73166
    608     98.40805 99.17517 99.30988 99.42359 99.57628 99.66642 99.69712 99.75462
    610     98.56459 99.03575 99.54105 99.57042 99.58063 99.67334 99.70192 99.70894
    611     99.28989 99.34500 99.42360 99.63499 99.67647 99.69492 99.75931 99.79111
    612     98.35357 98.75819 99.57399 99.62806 99.75442 99.79322 99.80536 99.86575
    F7.2.B  98.44307 98.84789 99.13640 99.28178 99.54744 99.57717 99.60148 99.62910
    F7.2.C  98.61956 98.71388 99.31681 99.41169 99.59578 99.66372 99.68429 99.69878
    F7.2.D  98.84371 98.99515 99.37945 99.45525 99.62856 99.66581 99.68848 99.70142
    F7.2.F  97.71927 98.40850 98.66765 98.90904 99.46531 99.53527 99.56340 99.65255
    F7.2.G  98.09660 98.60953 99.16564 99.28556 99.33313 99.33906 99.45955 99.49893
    F7.2.H  98.06158 98.50412 98.69634 99.11121 99.16565 99.31536 99.38783 99.42256
    F7.2.J  99.25628 99.55228 99.67611 99.71714 99.73067 99.75905 99.79578 99.80276
    F7.2.K  99.37561 99.55484 99.66649 99.72596 99.74230 99.76459 99.77285 99.79036
    F7.2.L  99.06262 99.26508 99.30690 99.47928 99.53866 99.60897 99.73313 99.80769
    F7.2.M  98.63740 99.07945 99.70921 99.73488 99.74092 99.74595 99.82250 99.82500
    F7.2.N  99.45782 99.51832 99.56324 99.60208 99.64801 99.68723 99.74904 99.84340
    F7.2.O  98.91271 98.98172 99.59246 99.71626 99.75320 99.78351 99.80192 99.82858
    F7.2.Q  99.07633 99.10038 99.64744 99.70244 99.75333 99.76070 99.81024 99.85869
    F7.2.R  98.50117 98.70438 99.49595 99.63700 99.66755 99.72450 99.75959 99.78373
    F7.2.S  99.28629 99.41788 99.43318 99.52393 99.54937 99.61388 99.66929 99.77095
    F7.3.A  97.41687 97.86491 98.59138 98.83384 98.92445 98.98395 99.31730 99.49608
    F7.3.AA 98.33871 98.70512 98.86794 98.91424 99.12993 99.16848 99.25239 99.26316
    F7.3.B  97.64550 97.88818 98.71653 99.03845 99.24848 99.44147 99.48100 99.51826
    F7.3.C  98.55341 98.64718 98.69170 98.98633 99.03775 99.17258 99.31170 99.37937
    F7.3.D  98.25763 98.78709 98.95272 99.12218 99.21119 99.29364 99.49987 99.54400
    F7.3.E  98.18929 98.49442 98.94154 98.97082 98.98046 99.08761 99.18554 99.26156
    F7.3.F  98.00425 98.21551 98.88839 99.10331 99.17386 99.27157 99.39767 99.48491
    F7.3.G  97.94074 98.14341 98.69783 98.98073 99.42009 99.45058 99.45533 99.47458
    F7.3.H  98.69179 99.17852 99.37932 99.49652 99.53310 99.62867 99.72911 99.75758
    F7.3.I  97.77116 97.93091 98.52186 98.79336 98.96867 99.07932 99.14173 99.17058
    F7.3.J  97.29626 97.64021 98.50814 98.91944 99.10345 99.15340 99.26031 99.26951
    F7.3.K  98.38109 98.54166 99.26581 99.30477 99.32784 99.44112 99.54964 99.59037
    F7.3.L  97.50844 97.65405 98.89490 99.09191 99.22093 99.30276 99.33415 99.38128
    F7.3.M  96.34651 96.88668 97.62495 97.88425 98.44240 98.58295 98.71900 98.82060
    F7.3.N  97.96842 98.33217 99.28629 99.35232 99.38401 99.51676 99.52841 99.54367
    F7.3.O  98.44717 98.64786 99.10237 99.20606 99.32111 99.42527 99.44933 99.56394
    F7.3.P  97.86166 98.00209 98.56243 98.82193 98.98222 99.08936 99.15515 99.18180
    F7.3.Q  99.04852 99.24080 99.35833 99.49190 99.50859 99.52105 99.58149 99.60369
    F7.3.R  96.95143 97.52525 97.87848 97.99355 98.42057 98.53682 98.68250 98.76792
    F7.3.S  98.79147 99.42733 99.46794 99.50322 99.75024 99.75616 99.77842 99.81520
    F7.3.T  97.95106 98.54729 98.68992 99.21519 99.35233 99.40538 99.45347 99.50968
    F7.3.U  96.44929 96.85238 97.56135 97.81653 98.57417 98.70494 99.08097 99.28740
    F7.3.V  97.62389 97.91212 98.38799 98.57980 98.63633 99.32732 99.45274 99.59073
    F7.3.W  97.49491 97.95079 98.67689 98.82197 98.91035 99.01907 99.04831 99.16418
    F7.3.X  98.42124 98.59607 98.98709 99.03095 99.04409 99.15191 99.21188 99.28224
    F7.3.Y  98.40984 98.52046 99.17460 99.20353 99.21024 99.42359 99.47602 99.50246
    F7.3.Z  98.83476 98.89710 99.32333 99.59146 99.61112 99.76776 99.78181 99.82498
                 h16      h17      h18      h19      h20      h21      h22      h23
    592     99.83132 99.84610 99.88715 99.89573 99.90731 99.93076 99.94508 99.96723
    593     99.61742 99.70705 99.74410 99.78674 99.81910 99.84694 99.85996 99.87472
    594     99.73005 99.79644 99.81128 99.84448 99.88912 99.91990 99.94067 99.94662
    602     99.78188 99.83715 99.86094 99.87719 99.88900 99.90308 99.92518 99.94356
    604     99.88547 99.89929 99.92483 99.93878 99.95691 99.96280 99.96444 99.97699
    605     99.85945 99.87214 99.89798 99.90948 99.93175 99.95223 99.96002 99.97902
    606     99.84276 99.85951 99.90312 99.91563 99.94320 99.94803 99.96068 99.96718
    607     99.78948 99.80602 99.82175 99.86032 99.86983 99.87466 99.89022 99.90041
    608     99.79066 99.84864 99.86163 99.88060 99.89695 99.92814 99.94686 99.96489
    610     99.75117 99.77743 99.84006 99.84986 99.85516 99.87985 99.88863 99.90279
    611     99.86018 99.86475 99.88851 99.91853 99.92616 99.93241 99.96050 99.96792
    612     99.87854 99.88255 99.90138 99.90368 99.93151 99.94218 99.95221 99.95699
    F7.2.B  99.69784 99.79634 99.82338 99.86232 99.87651 99.90061 99.90525 99.93040
    F7.2.C  99.80230 99.83163 99.86255 99.86784 99.88858 99.91353 99.93148 99.94325
    F7.2.D  99.75675 99.81288 99.83172 99.87124 99.87382 99.87832 99.90874 99.91560
    F7.2.F  99.67810 99.69046 99.73759 99.76127 99.77101 99.80316 99.83622 99.85700
    F7.2.G  99.52051 99.57882 99.59478 99.68360 99.70927 99.75223 99.79173 99.83030
    F7.2.H  99.44828 99.46174 99.46994 99.56082 99.57684 99.67346 99.75698 99.80964
    F7.2.J  99.84594 99.85695 99.88148 99.90943 99.91557 99.93731 99.93940 99.95703
    F7.2.K  99.81508 99.82512 99.85915 99.87814 99.91727 99.92434 99.93817 99.94171
    F7.2.L  99.83181 99.89591 99.92009 99.92737 99.93735 99.94551 99.96043 99.96650
    F7.2.M  99.82596 99.86250 99.88890 99.93028 99.94067 99.94669 99.95795 99.96326
    F7.2.N  99.87938 99.92458 99.93161 99.93589 99.94746 99.95700 99.96220 99.97442
    F7.2.O  99.85073 99.86203 99.87120 99.89878 99.93963 99.95864 99.96050 99.96944
    F7.2.Q  99.88407 99.91424 99.91815 99.92211 99.96743 99.97206 99.97380 99.99086
    F7.2.R  99.81136 99.82682 99.84711 99.85440 99.90120 99.92598 99.94357 99.96011
    F7.2.S  99.82369 99.89996 99.91920 99.92238 99.94817 99.95127 99.95742 99.96668
    F7.3.A  99.52857 99.61377 99.63107 99.66312 99.71226 99.80122 99.81953 99.85149
    F7.3.AA 99.31900 99.37208 99.59446 99.67856 99.72364 99.77507 99.82874 99.86419
    F7.3.B  99.62263 99.66733 99.71405 99.71877 99.74911 99.76806 99.77526 99.78254
    F7.3.C  99.47780 99.57109 99.62049 99.82614 99.84268 99.86713 99.88892 99.90305
    F7.3.D  99.58935 99.67176 99.76047 99.79086 99.83489 99.85760 99.86256 99.86977
    F7.3.E  99.30055 99.47420 99.55857 99.56825 99.59022 99.67262 99.68245 99.75637
    F7.3.F  99.55564 99.68187 99.70367 99.78771 99.83442 99.89018 99.89257 99.91897
    F7.3.G  99.54796 99.60831 99.64972 99.66862 99.72394 99.73785 99.82448 99.85912
    F7.3.H  99.79898 99.80237 99.84241 99.86928 99.88073 99.91235 99.91562 99.94619
    F7.3.I  99.44301 99.51964 99.56588 99.59121 99.65785 99.73857 99.77062 99.81153
    F7.3.J  99.31685 99.34475 99.38234 99.43099 99.49914 99.51430 99.65645 99.69136
    F7.3.K  99.62584 99.69480 99.72728 99.79702 99.82830 99.85207 99.91352 99.93333
    F7.3.L  99.51031 99.53041 99.57802 99.63666 99.67373 99.70176 99.79688 99.80248
    F7.3.M  98.88296 98.90820 99.05297 99.19683 99.28099 99.55601 99.61602 99.63619
    F7.3.N  99.69080 99.73353 99.78018 99.79882 99.86109 99.88041 99.90562 99.91368
    F7.3.O  99.65397 99.67483 99.67896 99.68650 99.73029 99.74078 99.77720 99.79975
    F7.3.P  99.47190 99.54765 99.59327 99.61299 99.68114 99.74483 99.77746 99.81361
    F7.3.Q  99.65588 99.66564 99.74053 99.74583 99.76569 99.83158 99.86917 99.91922
    F7.3.R  98.83419 99.12726 99.31042 99.43932 99.55181 99.59208 99.74120 99.77324
    F7.3.S  99.83200 99.83515 99.87953 99.90306 99.91072 99.93918 99.94295 99.94602
    F7.3.T  99.68461 99.73525 99.84015 99.87836 99.88584 99.90447 99.91925 99.93361
    F7.3.U  99.44505 99.67876 99.78378 99.82268 99.83566 99.84542 99.87344 99.88574
    F7.3.V  99.64890 99.72333 99.88181 99.91779 99.93802 99.95080 99.95757 99.96929
    F7.3.W  99.21054 99.26933 99.43650 99.44771 99.46990 99.55777 99.63303 99.68731
    F7.3.X  99.33657 99.41381 99.54067 99.58758 99.72141 99.81335 99.86074 99.90723
    F7.3.Y  99.55135 99.56575 99.58473 99.65200 99.75733 99.81344 99.86448 99.88235
    F7.3.Z  99.89071 99.89686 99.90788 99.93179 99.93821 99.95716 99.95970 99.97277
                 h24      h25      h26      h27      h28 h29
    592     99.98078 99.98660 99.98851 99.99408 99.99572 100
    593     99.89325 99.90562 99.92733 99.94748 99.96955 100
    594     99.95043 99.95703 99.96357 99.98561 99.98846 100
    602     99.94541 99.98106 99.98733 99.98943 99.99485 100
    604     99.97814 99.98211 99.98947 99.99588 99.99798 100
    605     99.98365 99.98398 99.98830 99.98869 99.99665 100
    606     99.96893 99.97506 99.97792 99.99091 99.99415 100
    607     99.91025 99.92804 99.93493 99.94356 99.97156 100
    608     99.96927 99.98565 99.98728 99.99088 99.99760 100
    610     99.91303 99.92166 99.94279 99.97105 99.98533 100
    611     99.97573 99.98317 99.98588 99.99241 99.99792 100
    612     99.95768 99.96528 99.97225 99.98204 99.99396 100
    F7.2.B  99.93797 99.97342 99.98460 99.98780 99.99310 100
    F7.2.C  99.96280 99.96805 99.98054 99.98354 99.98521 100
    F7.2.D  99.91812 99.93614 99.94808 99.95722 99.99085 100
    F7.2.F  99.89568 99.90739 99.93361 99.96339 99.98995 100
    F7.2.G  99.83336 99.87201 99.90289 99.90890 99.96587 100
    F7.2.H  99.84345 99.89386 99.90587 99.93014 99.95633 100
    F7.2.J  99.96936 99.98233 99.98632 99.99339 99.99419 100
    F7.2.K  99.94786 99.95442 99.95994 99.96497 99.99206 100
    F7.2.L  99.96726 99.97608 99.98248 99.98661 99.99854 100
    F7.2.M  99.97914 99.99110 99.99434 99.99646 99.99707 100
    F7.2.N  99.97595 99.98220 99.99226 99.99322 99.99798 100
    F7.2.O  99.97346 99.98214 99.98858 99.99418 99.99522 100
    F7.2.Q  99.99198 99.99263 99.99421 99.99628 99.99843 100
    F7.2.R  99.96502 99.97005 99.97893 99.98986 99.99449 100
    F7.2.S  99.96997 99.97713 99.98648 99.98790 99.99810 100
    F7.3.A  99.88217 99.93380 99.95555 99.96616 99.98611 100
    F7.3.AA 99.88355 99.90967 99.95563 99.98919 99.99079 100
    F7.3.B  99.80557 99.87065 99.89655 99.91580 99.95185 100
    F7.3.C  99.91544 99.93053 99.97405 99.98869 99.99523 100
    F7.3.D  99.91236 99.92362 99.93601 99.96981 99.98645 100
    F7.3.E  99.83372 99.94655 99.95866 99.96946 99.98135 100
    F7.3.F  99.94025 99.96236 99.97866 99.97887 99.98334 100
    F7.3.G  99.86874 99.92508 99.93761 99.96172 99.96923 100
    F7.3.H  99.95059 99.96153 99.96590 99.97831 99.99786 100
    F7.3.I  99.91171 99.93079 99.95642 99.98221 99.99645 100
    F7.3.J  99.79494 99.88312 99.92728 99.96984 99.99112 100
    F7.3.K  99.94993 99.96479 99.96847 99.98189 99.99226 100
    F7.3.L  99.83996 99.85913 99.89615 99.93538 99.97152 100
    F7.3.M  99.77097 99.82730 99.88366 99.95512 99.96219 100
    F7.3.N  99.93244 99.94912 99.96594 99.98787 99.99797 100
    F7.3.O  99.82714 99.86198 99.94878 99.97346 99.99059 100
    F7.3.P  99.90611 99.92787 99.96015 99.98006 99.99325 100
    F7.3.Q  99.94814 99.97415 99.98388 99.98506 99.99198 100
    F7.3.R  99.88229 99.92087 99.96463 99.98188 99.99076 100
    F7.3.S  99.95992 99.96638 99.97949 99.99365 99.99622 100
    F7.3.T  99.96435 99.97243 99.97823 99.98566 99.99427 100
    F7.3.U  99.92709 99.96733 99.97652 99.98438 99.99201 100
    F7.3.V  99.97742 99.98074 99.98928 99.99088 99.99265 100
    F7.3.W  99.74634 99.84397 99.91094 99.96888 99.99373 100
    F7.3.X  99.93199 99.94006 99.96597 99.97673 99.98225 100
    F7.3.Y  99.91304 99.92840 99.95138 99.96964 99.98615 100
    F7.3.Z  99.97844 99.98676 99.99075 99.99556 99.99860 100

    $minh
      90%   95%   99% 99.9% 
        5     7    11    23 

``` r
# generate efa outlines
efa.outlines <- efourier(norm.outlines, 
                         nb.h = 23,
                         norm = TRUE)

# use efa.outlines for pca
pca.outlines <- PCA(efa.outlines)
```

### PCA

``` r
# plot pca by trinomial
plot_PCA(pca.outlines, 
         morphospace_position = "xy",
         palette = pal_qual_solarized,
         chullfilled = TRUE,
         ~site,
         labelgroups = TRUE,
         legend = FALSE,
         axesnames = TRUE,
         morphospace = TRUE,
         eigen = TRUE,
         zoom = 0.85)
```

<img src="exogamy.1_files/figure-gfm/pca.plot-1.png"
style="width:100.0%" />

``` r
# plot pca by burial
plot_PCA(pca.outlines, 
         morphospace_position = "xy",
         palette = pal_qual_solarized,
         chullfilled = TRUE,
         ~burial,
         labelgroups = TRUE,
         legend = FALSE,
         axesnames = TRUE,
         morphospace = TRUE,
         eigen = TRUE,
         zoom = 0.85)
```

<img src="exogamy.1_files/figure-gfm/pca.plot-2.png"
style="width:100.0%" />

``` r
# mean shape + 2sd for the first 5 pcs
PCcontrib(pca.outlines, nax = 1:5)
```

<img src="exogamy.1_files/figure-gfm/pca.plot-3.png"
style="width:100.0%" />

### MANOVA

``` r
# shape difference between sites?
MANOVA(pca.outlines, 'site')
```

    PC axes 1 to 18 were retained

              Df Hotelling-Lawley approx F num Df den Df   Pr(>F)   
    fac        1           1.6548   3.2176     18     35 0.001499 **
    Residuals 52                                                    
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

``` r
# shape difference between burials?
MANOVA(pca.outlines, 'burial')
```

    PC axes 1 to 18 were retained

              Df Hotelling-Lawley approx F num Df den Df    Pr(>F)    
    fac        5           13.005   4.2482     90    147 4.195e-15 ***
    Residuals 48                                                      
    ---
    Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

``` r
# which differ?
MANOVA_PW(pca.outlines, 'burial')
```

    'B36' has 3 rows, and 'retain' is set accordingly

    PC axes 1 to 3 were retained

    B1B19

    B1B36

    B1F2.2072

    B1F2.2073

    B1F8.1091

    B19B36

    B19F2.2072

    B19F2.2073

    B19F8.1091

    B36F2.2072

    B36F2.2073

    B36F8.1091

    F2.2072F2.2073

    F2.2072F8.1091

    F2.2073F8.1091

    $stars.tab
            B1 B19 B36 F2.2072 F2.2073 F8.1091
    B1         -   .   *       -       ***    
    B19            *   *       **      ***    
    B36                -       **      ***    
    F2.2072                    *       -      
    F2.2073                            ***    

    $summary (see also $manovas)
                      Df Pillai approx F num Df den Df    Pr(>F)
    B1 - B19           1 0.3906    1.068      3      5 4.410e-01
    B1 - B36           1 0.7913    5.054      3      4 7.577e-02
    B1 - F2.2072       1 0.7343    6.449      3      7 2.004e-02
    B1 - F2.2073       1 0.3459    1.763      3     10 2.175e-01
    B1 - F8.1091       1 0.6006   14.032      3     28 9.035e-06
    B19 - B36          1 0.9663   28.653      3      3 1.041e-02
    B19 - F2.2072      1 0.7519    6.060      3      6 3.014e-02
    B19 - F2.2073      1 0.8045   12.347      3      9 1.530e-03
    B19 - F8.1091      1 0.7104   22.083      3     27 1.970e-07
    B36 - F2.2072      1 0.5791    2.293      3      5 1.954e-01
    B36 - F2.2073      1 0.8367   13.667      3      8 1.630e-03
    B36 - F8.1091      1 0.5694   11.461      3     26 5.668e-05
    F2.2072 - F2.2073  1 0.4996    3.661      3     11 4.747e-02
    F2.2072 - F8.1091  1 0.1306    1.452      3     29 2.480e-01
    F2.2073 - F8.1091  1 0.4674    9.360      3     32 1.368e-04

### Mean shapes

``` r
# mean shapes by site
ms.1 <- MSHAPES(efa.outlines, ~site)
plot_MSHAPES(ms.1, size = 0.75)
```

<img src="exogamy.1_files/figure-gfm/ms1-1.png" style="width:100.0%" />

``` r
# mean shapes by burial
ms.1 <- MSHAPES(efa.outlines, ~burial)
plot_MSHAPES(ms.1, size = 0.75)
```

<img src="exogamy.1_files/figure-gfm/ms1-2.png" style="width:100.0%" />

``` r
## characterise shape diffs by significant results
# mean shapes for 41cp5/41hs15
ms.2 <- MSHAPES(efa.outlines, ~site, nb.pts = 100)$shp
Carpenter <- ms.2$Carpenter
PTM <- ms.2$PTM
par(mfrow=c(2,2))
tps_iso(Carpenter, PTM, iso.nb = 1000, grid = TRUE, legend = FALSE)
tps_arr(Carpenter, PTM, arr.nb = 200, grid = TRUE, legend = FALSE)
tps_grid(Carpenter, PTM, grid.size = 50)

# mean shapes for B19/B36
ms.3 <- MSHAPES(efa.outlines, ~burial, nb.pts = 100)$shp
B19 <- ms.3$B19
B36 <- ms.3$B36
par(mfrow=c(2,2))
```

<img src="exogamy.1_files/figure-gfm/ms1-3.png" style="width:100.0%" />

``` r
tps_iso(B19, B36, iso.nb = 1000, grid = TRUE, legend = FALSE)
tps_arr(B19, B36, arr.nb = 200, grid = TRUE, legend = FALSE)
tps_grid(B19, B36, grid.size = 50)

# mean shapes for F2.2072/F2.2073
F2.2072 <- ms.3$F2.2072
F2.2073 <- ms.3$F2.2073
par(mfrow=c(2,2))
```

<img src="exogamy.1_files/figure-gfm/ms1-4.png" style="width:100.0%" />

``` r
tps_iso(F2.2073, F2.2072, iso.nb = 1000, grid = TRUE, legend = FALSE)
tps_arr(F2.2073, F2.2072, arr.nb = 200, grid = TRUE, legend = FALSE)
tps_grid(F2.2073, F2.2072, grid.size = 50)

# mean shapes for F2.2073/F8.1091
F8.1091 <- ms.3$F8.1091
par(mfrow=c(2,2))
```

<img src="exogamy.1_files/figure-gfm/ms1-5.png" style="width:100.0%" />

``` r
tps_iso(F2.2073, F8.1091, iso.nb = 1000, grid = TRUE, legend = FALSE)
tps_arr(F2.2073, F8.1091, arr.nb = 200, grid = TRUE, legend = FALSE)
tps_grid(F2.2073, F8.1091, grid.size = 50)
```

<img src="exogamy.1_files/figure-gfm/ms1-6.png" style="width:100.0%" />
